ModuleName: ChangefeedsIncludeStates
TableVarNames:
- tbl
DefsAndTests:
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 1
  Original: '[{''state'': ''ready''}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "ready"))
  Obtained: tbl.changes().optArg("squash", true).optArg("include_states", true).limit(1)
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 2
  Original: '[{''state'': ''initializing''}, {''new_val'': None}, {''state'': ''ready''}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("new_val", null), new MapObject().with("state", "ready"))
  Obtained: tbl.get(0).changes().optArg("squash", true).optArg("include_states", true).limit(3)
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 3
  Original: '[{''state'': ''initializing''}, {''state'': ''ready''}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("state", "ready"))
  Obtained: tbl.orderBy().optArg("index", "id").limit(10).changes().optArg("squash", true).optArg("include_states", true).limit(2)
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 4
  Original: None
  ExpectedType: Object
  ExpectedJava: null
  Obtained: tbl.insert(new MapObject().with("id", 1))
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 5
  Original: '[{''state'': ''initializing''}, {''new_val'': {''id'': 1}}, {''state'': ''ready''}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("new_val", new MapObject().with("id", 1)), new MapObject().with("state", "ready"))
  Obtained: tbl.orderBy().optArg("index", "id").limit(10).changes().optArg("squash", true).optArg("include_states", true).limit(3)
- TestType: JavaDef
  TestFile: changefeeds/include_states.yaml
  TestNum: 6
  Original: tblchanges = tbl.changes(squash=true, include_states=true)
  Java: Changes tblchanges = (Changes) tbl.changes().optArg("squash", true).optArg("include_states", true);
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 7
  Original: None
  ExpectedType: Object
  ExpectedJava: null
  Obtained: tbl.insert(new MapObject().with("id", 2))
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 8
  Original: '[{''state'': ''ready''}, {''new_val'': {''id'': 2}, ''old_val'': None}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "ready"), new MapObject().with("new_val", new MapObject().with("id", 2)).with("old_val", null))
  Obtained: fetch(tblchanges, 2)
- TestType: JavaDef
  TestFile: changefeeds/include_states.yaml
  TestNum: 9
  Original: getchanges = tbl.get(2).changes(include_states=true)
  Java: Changes getchanges = (Changes) tbl.get(2).changes().optArg("include_states", true);
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 10
  Original: None
  ExpectedType: Object
  ExpectedJava: null
  Obtained: tbl.get(2).update(new MapObject().with("a", 1))
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 11
  Original: '[{''state'': ''initializing''}, {''new_val'': {''id'': 2}}, {''state'': ''ready''}, {''new_val'': {''id'': 2, ''a'': 1}, ''old_val'': {''id'': 2}}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("new_val", new MapObject().with("id", 2)), new MapObject().with("state", "ready"), new MapObject().with("new_val", new MapObject().with("id", 2).with("a", 1)).with("old_val", new MapObject().with("id", 2)))
  Obtained: fetch(getchanges, 4)
- TestType: JavaDef
  TestFile: changefeeds/include_states.yaml
  TestNum: 12
  Original: limitchanges = tbl.order_by(index='id').limit(10).changes(include_states=true)
  Java: Changes limitchanges = (Changes) tbl.orderBy().optArg("index", "id").limit(10).changes().optArg("include_states", true);
- TestType: JavaDef
  TestFile: changefeeds/include_states.yaml
  TestNum: 13
  Original: limitchangesdesc = tbl.order_by(index=r.desc('id')).limit(10).changes(include_states=true)
  Java: Changes limitchangesdesc = (Changes) tbl.orderBy().optArg("index", r.desc("id")).limit(10).changes().optArg("include_states", true);
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 14
  Original: None
  ExpectedType: Object
  ExpectedJava: null
  Obtained: tbl.insert(new MapObject().with("id", 3))
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 15
  Original: '[{''state'': ''initializing''}, {''new_val'': {''id'': 1}}, {''new_val'': {''id'': 2, ''a'': 1}}, {''state'': ''ready''}, {''new_val'': {''id'': 3}, ''old_val'': None}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("new_val", new MapObject().with("id", 1)), new MapObject().with("new_val", new MapObject().with("id", 2).with("a", 1)), new MapObject().with("state", "ready"), new MapObject().with("new_val", new MapObject().with("id", 3)).with("old_val", null))
  Obtained: fetch(limitchanges, 5)
- TestType: JavaQuery
  TestFile: changefeeds/include_states.yaml
  TestNum: 16
  Original: '[{''state'': ''initializing''}, {''new_val'': {''id'': 2, ''a'': 1}}, {''new_val'': {''id'': 1}}, {''state'': ''ready''}, {''new_val'': {''id'': 3}, ''old_val'': None}]'
  ExpectedType: List
  ExpectedJava: Arrays.asList(new MapObject().with("state", "initializing"), new MapObject().with("new_val", new MapObject().with("id", 2).with("a", 1)), new MapObject().with("new_val", new MapObject().with("id", 1)), new MapObject().with("state", "ready"), new MapObject().with("new_val", new MapObject().with("id", 3)).with("old_val", null))
  Obtained: fetch(limitchangesdesc, 5)
